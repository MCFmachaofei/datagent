{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dataplumber.js","webpack:///webpack/bootstrap e30e81725df4a4984fce","webpack:///./src/utils/index.js","webpack:///./src/classes/Hooks.class.js","webpack:///./src/classes/Method.class.js","webpack:///./src/classes/Schema.class.js","webpack:///./src/DataPlumber.js","webpack:///./src/classes/Contact.class.js","webpack:///./src/classes/Remote.class.js","webpack:///./src/index.js","webpack:///./src/operations/index.js","webpack:///./src/classes/Model.class.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","_defineProperty","obj","key","value","writable","convert","format","arguments","length","undefined","options","defaults","data","fields","concat","keys","result","forEach","fieldName","fieldSet","isDef","formatField","type","default","to","defaultVal","val","isNumber","NaN","mapReceiveHook","methods","__WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__","ReceiveBehaviour","mapHooks","mapSendHook","SendBehaviour","Error","isArray","hooks","map","hookName","reduce","assign","isNew","getURL","compose","id","url","emulateIdKey","constructor","Array","Number","_len","list","_key","acc","fn","then","Promise","resolve","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","Hooks","_map","Map","operations","set","size","_ref","method","hook","isReceiveBehaviour","isSendBehaviour","indexOf","_toConsumableArray","arr","arr2","from","__WEBPACK_IMPORTED_MODULE_0__utils___","Method","queues","queue","args","ctx","reject","catch","arg","x","y","filter","schema","Schema","_fieldSet","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","ModelFactory","__WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__","fetch","__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__","find","save","delete","RichModel","_Model","opts","_this","getPrototypeOf","initHooks","_hooks","HooksFactory","methodName","before","after","__WEBPACK_IMPORTED_MODULE_6__classes_Method_class__","getHooks","apply","scope","generate","ContactFactory","remotes","contact","__WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__","remoteName","index","remote","__WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__","origin","__WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__","aboutName","addHooks","_extends","source","Model","Contact","__WEBPACK_IMPORTED_MODULE_0__Remote_class__","__WEBPACK_IMPORTED_MODULE_1__utils___","_remotes","_default_remote","has","RangeError","Remote","_origin","params","sync","__WEBPACK_IMPORTED_MODULE_0__operations___","__WEBPACK_IMPORTED_MODULE_1__DataPlumber__","__WEBPACK_IMPORTED_MODULE_2__utils___","requestData","res","status","err","message","respose","response","awaitTo","promise","item","pop","formatFor","field","__WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__","filterFor","__WEBPACK_IMPORTED_MODULE_1__Contact_class__","_name","_url","_contact","_emulateIdKey","_defaults","_defaults2","_defaults3","_defaults4"],"mappings":"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","file":"dataplumber.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dataplumber\"] = factory();\n\telse\n\t\troot[\"dataplumber\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dataplumber\"] = factory();\n\telse\n\t\troot[\"dataplumber\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 7);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"h\", function() { return isNew; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return getURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return isDef; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return isArray; });\n/* unused harmony export isNumber */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return defaults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return compose; });\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = convert;\n/* unused harmony export formatField */\n/* harmony export (immutable) */ __webpack_exports__[\"i\"] = mapReceiveHook;\n/* harmony export (immutable) */ __webpack_exports__[\"j\"] = mapSendHook;\n/* unused harmony export mapHooks */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__classes_Method_class__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__ = __webpack_require__(1);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nvar isNew = function isNew(data) {\n    return !isDef(data.id);\n};\nvar getURL = function getURL(url, id, emulateIdKey) {\n    return emulateIdKey ? url : url + (isDef(id) ? '/' + id : '');\n};\nvar isDef = function isDef(val) {\n    return typeof val !== 'undefined';\n};\nvar isArray = function isArray(val) {\n    return val.constructor === Array;\n};\nvar isNumber = function isNumber(val) {\n    return val.constructor === Number;\n};\nvar defaults = function defaults(obj) {\n    var defaults = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var merge = function merge(defaults, obj) {\n        return defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\n    };\n    return isDef(obj) ? merge(defaults, obj) : defaults;\n};\n\nvar compose = function compose() {\n    for (var _len = arguments.length, list = Array(_len), _key = 0; _key < _len; _key++) {\n        list[_key] = arguments[_key];\n    }\n\n    return function (acc) {\n        return list.reduce(function (acc, fn) {\n            return acc.then(fn);\n        }, Promise.resolve(acc));\n    };\n};\n\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\nfunction convert() {\n    var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var options = arguments[1];\n\n    options = defaults(options, { format: false });\n    return function () {\n        var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [].concat(Object.keys(data), Object.keys(format));\n\n        var result = {};\n        fields.forEach(function (fieldName) {\n            var fieldSet = format[fieldName];\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\n        });\n        return result;\n    };\n}\n\nfunction formatField(to, defaultVal) {\n    return function (val) {\n        var result = void 0;\n        if (!isDef(val)) result = defaultVal;else result = to(val);\n        if (defaultVal === result) return result;\n        if (isNumber(result) && result === NaN) result = defaultVal;\n        if (result === null) result = defaultVal;\n        return result;\n    };\n}\n\nfunction mapReceiveHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].ReceiveBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapSendHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].SendBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapHooks(methods) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\n    var result = options.methods.map(function (hookName) {\n        return _defineProperty({}, hookName, {});\n    }).reduce(Object.assign);\n    Object.keys(result).forEach(function (hookName) {\n        result[hookName] = options.hooks.map(function (hookName) {\n            return _defineProperty({}, hookName, methods);\n        }).reduce(Object.assign);\n    });\n    return result;\n}\n\n/* harmony default export */ __webpack_exports__[\"c\"] = ({\n    isNew: isNew,\n    getURL: getURL,\n    isDef: isDef,\n    defaults: defaults,\n    convert: convert,\n    compose: compose,\n    mapSendHook: mapSendHook,\n    mapReceiveHook: mapReceiveHook\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Hooks = function () {\n    function Hooks() {\n        _classCallCheck(this, Hooks);\n\n        this._map = new Map();\n    }\n\n    _createClass(Hooks, [{\n        key: 'addHooks',\n        value: function addHooks(key, operations) {\n            return this._map.set(key, operations);\n        }\n    }, {\n        key: 'getHooks',\n        value: function getHooks(key) {\n            return this._map.get(key);\n        }\n    }, {\n        key: 'each',\n        value: function each(fn) {\n            return this._map.forEach(fn);\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return this._map.size;\n        }\n    }], [{\n        key: 'parse',\n        value: function parse(_ref) {\n            var method = _ref.method,\n                hook = _ref.hook;\n            var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'method';\n\n            var result = method + ':' + hook;\n            if (type === 'behaviour') {\n                if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\n                if (Hooks.isSendBehaviour(method, hook)) result = 'send';\n            }\n            return result;\n        }\n    }, {\n        key: 'isReceiveBehaviour',\n        value: function isReceiveBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\n            return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'isSendBehaviour',\n        value: function isSendBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\n            return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'ReceiveBehaviour',\n        get: function get() {\n            return {\n                methods: ['fetch', 'find'],\n                hooks: ['after']\n            };\n        }\n    }, {\n        key: 'SendBehaviour',\n        get: function get() {\n            return {\n                methods: ['save'],\n                hooks: ['before']\n            };\n        }\n    }]);\n\n    return Hooks;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Hooks);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// import compose from 'koa-compose';\n\n\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\n\nvar Method = function () {\n    function Method() {\n        _classCallCheck(this, Method);\n    }\n\n    _createClass(Method, null, [{\n        key: 'generate',\n        value: function generate(queues) {\n            var queue = __WEBPACK_IMPORTED_MODULE_0__utils___[\"a\" /* compose */].apply(undefined, _toConsumableArray(queues));\n            return function (args) {\n                var ctx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n                ctx = Object.assign(ctx, { args: args });\n                return new Promise(function (resolve, reject) {\n                    queue(ctx).then(function (ctx) {\n                        return resolve(ctx.result);\n                    }).catch(reject);\n                });\n            };\n        }\n    }, {\n        key: 'concat',\n        value: function concat() {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            return args.map(function (arg) {\n                return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(arg, []);\n            }).reduce(function (x, y) {\n                return x.concat(y);\n            });\n        }\n    }]);\n\n    return Method;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Method);\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export format */\n/* unused harmony export filter */\n/* unused harmony export schema */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar _format = function _format(data, fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })(data);\n};\n\nvar _filter = function _filter(data, fields) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])()(data, fields);\n};\n\nvar schema = function schema(fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })({}, Object.keys(fieldSet));\n};\n\nvar Schema = function () {\n    function Schema(fieldSet) {\n        _classCallCheck(this, Schema);\n\n        this._fieldSet = fieldSet;\n    }\n\n    _createClass(Schema, [{\n        key: \"format\",\n        value: function format(data) {\n            return _format(data, this._fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data) {\n            var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Object.keys(this._fieldSet);\n\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default() {\n            return schema(this._fieldSet);\n        }\n    }, {\n        key: \"fieldSet\",\n        get: function get() {\n            return this._fieldSet;\n        }\n\n        // static\n\n    }], [{\n        key: \"format\",\n        value: function format(data, fieldSet) {\n            return _format(data, fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data, fields) {\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default(fieldSet) {\n            return schema(fieldSet);\n        }\n    }]);\n\n    return Schema;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Schema);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = ModelFactory;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = ContactFactory;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = HooksFactory;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__ = __webpack_require__(2);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\n\nfunction ModelFactory(options) {\n    var schema = new __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__[\"a\" /* default */](options.fields);\n    var methods = _extends({\n        'fetch': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.fetch,\n        'find': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.find,\n        'save': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.save,\n        'delete': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.delete\n    }, options.methods);\n    //RichModel\n\n    var RichModel = function (_Model) {\n        _inherits(RichModel, _Model);\n\n        function RichModel(opts) {\n            _classCallCheck(this, RichModel);\n\n            opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts);\n            opts.name = options.name;\n\n            var _this = _possibleConstructorReturn(this, (RichModel.__proto__ || Object.getPrototypeOf(RichModel)).call(this, opts));\n\n            _this.initHooks(options.hooks);\n            return _this;\n        }\n\n        _createClass(RichModel, [{\n            key: 'initHooks',\n            value: function initHooks(options) {\n                this._hooks = HooksFactory(options);\n            }\n        }, {\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }], [{\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }]);\n\n        return RichModel;\n    }(__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */]);\n\n    Object.keys(methods).forEach(function (methodName) {\n        // all hook action magic in here.\n        RichModel.prototype[methodName] = function () {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            var opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(args[args.length - 1]);\n            var hooks = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts.hooks, { before: [], after: [] });\n\n            var before = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.before, this._hooks.getHooks(methodName + '::before'));\n            var after = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.after, this._hooks.getHooks(methodName + '::after'));\n\n            var method = function method(ctx) {\n                return methods[methodName].apply(ctx.scope, ctx.args).then(function (data) {\n                    ctx.hook = 'after';\n                    ctx.result = data;\n                    return Promise.resolve(ctx);\n                });\n            };\n            var ctx = { scope: this, method: methodName, hook: 'before' };\n\n            return __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].generate([].concat(_toConsumableArray(before), [method], _toConsumableArray(after)))(args, ctx);\n        };\n    });\n\n    return RichModel;\n}\n\nfunction ContactFactory() {\n    var remotes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var defaults = arguments[1];\n\n    var contact = new __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__[\"a\" /* default */]();\n    Object.keys(remotes).forEach(function (remoteName, index) {\n        contact.remote(remoteName, new __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__[\"a\" /* default */]({ origin: remotes[remoteName] }), { default: index == 0 });\n    });\n    if (defaults) contact.default(defaults);\n    return contact;\n}\n\nfunction HooksFactory(options) {\n    var hooks = new __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__[\"a\" /* default */]();\n    //解析hooks的逻辑，并添加hook记录\n\n    Object.keys(__WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(options)).forEach(function (hookName) {\n        var hook = options[hookName];\n        Object.keys(hook).forEach(function (aboutName) {\n            hooks.addHooks(hookName + '::' + aboutName, hook[aboutName]);\n        });\n    });\n\n    return hooks;\n}\n\n/* harmony default export */ __webpack_exports__[\"d\"] = ({\n    Model: ModelFactory,\n    Contact: ContactFactory,\n    Hooks: HooksFactory\n});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Remote_class__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Contact = function () {\n    function Contact() {\n        _classCallCheck(this, Contact);\n\n        this._remotes = {};\n        this._default_remote = \"\";\n    }\n\n    _createClass(Contact, [{\n        key: 'remote',\n        value: function remote() {\n            var name = arguments.length <= 0 ? undefined : arguments[0],\n                remote = arguments.length <= 1 ? undefined : arguments[1],\n                opts = Object(__WEBPACK_IMPORTED_MODULE_1__utils___[\"d\" /* defaults */])(arguments.length <= 2 ? undefined : arguments[2], { default: false });\n            if (arguments.length >= 2) {\n                // set remote\n                if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\n                if (remote.constructor !== __WEBPACK_IMPORTED_MODULE_0__Remote_class__[\"a\" /* default */]) throw new TypeError('The second arguments must be Remote');\n                this._remotes[name] = remote;\n                if (opts.default || this.length == 1) this.default(name);\n            } else {\n                name = name ? name : this._default_remote;\n                if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in remote()');\n                // get remote\n                remote = this._remotes[name];\n                return remote;\n            }\n        }\n    }, {\n        key: 'default',\n        value: function _default(name) {\n            if (typeof name !== 'string') throw new TypeError('The name must be string in default()');\n            if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in default()');\n            this._default_remote = name;\n        }\n    }, {\n        key: 'has',\n        value: function has(name) {\n            return Object.keys(this._remotes).indexOf(name) !== -1;\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return Object.keys(this._remotes).length;\n        }\n    }]);\n\n    return Contact;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Contact);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Remote = function () {\n    function Remote(options) {\n        _classCallCheck(this, Remote);\n\n        this._origin = options.origin;\n    }\n\n    _createClass(Remote, [{\n        key: 'get',\n        value: function get(url, params) {\n            return this.sync({\n                url: url,\n                method: 'GET',\n                params: params\n            });\n        }\n    }, {\n        key: 'post',\n        value: function post(url, data) {\n            return this.sync({\n                method: 'POST',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'put',\n        value: function put(url, data) {\n            return this.sync({\n                method: 'PUT',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'patch',\n        value: function patch(url, data) {\n            return this.sync({\n                method: 'PATCH',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(url, data) {\n            return this.sync({\n                method: 'DELETE',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'sync',\n        value: function sync(options) {\n            return this._origin(options);\n        }\n    }, {\n        key: 'origin',\n        get: function get() {\n            return this._origin;\n        }\n    }]);\n\n    return Remote;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Remote);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__operations___ = __webpack_require__(8);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"requestData\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"f\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"awaitTo\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"format\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"d\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"filter\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"b\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"formatFor\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"e\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"filterFor\", function() { return __WEBPACK_IMPORTED_MODULE_0__operations___[\"c\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__DataPlumber__ = __webpack_require__(4);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"ModelFactory\", function() { return __WEBPACK_IMPORTED_MODULE_1__DataPlumber__[\"c\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"ContactFactory\", function() { return __WEBPACK_IMPORTED_MODULE_1__DataPlumber__[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"HooksFactory\", function() { return __WEBPACK_IMPORTED_MODULE_1__DataPlumber__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils___ = __webpack_require__(0);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"mapReceiveHook\", function() { return __WEBPACK_IMPORTED_MODULE_2__utils___[\"i\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"mapSendHook\", function() { return __WEBPACK_IMPORTED_MODULE_2__utils___[\"j\"]; });\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (_extends({}, __WEBPACK_IMPORTED_MODULE_1__DataPlumber__[\"d\" /* default */], {\n    mapReceiveHook: __WEBPACK_IMPORTED_MODULE_2__utils___[\"i\" /* mapReceiveHook */],\n    mapSendHook: __WEBPACK_IMPORTED_MODULE_2__utils___[\"j\" /* mapSendHook */]\n}));\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"f\"] = requestData;\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = awaitTo;\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = format;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = filter;\n/* harmony export (immutable) */ __webpack_exports__[\"e\"] = formatFor;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = filterFor;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__ = __webpack_require__(1);\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\n\n\n\nfunction requestData() {\n    return function (ctx) {\n        var res = ctx.result;\n        if (res.status < 200) {\n            var err = new Error(res.message);\n            err.respose = res.response;\n            throw err;\n        };\n        ctx.result = res.data;\n        return Promise.resolve(ctx);\n    };\n}\n\nfunction awaitTo(promise) {\n    return promise.then(function (data) {\n        return [null, data];\n    }).catch(function (err) {\n        return [err];\n    });\n}\n\nfunction format() {\n    return function (ctx) {\n        switch (ctx.hook) {\n            case 'after':\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(ctx.result) && Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isArray */])(ctx.result)) {\n                    ctx.result = ctx.result.map(function (item) {\n                        return ctx.scope.schema.format(item);\n                    });\n                } else {\n                    ctx.result = ctx.scope.schema.format(ctx.result);\n                }\n                break;\n            case 'before':\n                var data = ctx.args.pop();\n                ctx.args = [ctx.scope.schema.format(data)].concat(_toConsumableArray(ctx.args));\n                break;\n        }\n        return Promise.resolve(ctx);\n    };\n}\n\nfunction filter(fields) {\n    return function (ctx) {\n        switch (ctx.hook) {\n            case 'after':\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(ctx.result) && Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isArray */])(ctx.result)) {\n                    ctx.result = ctx.result.map(function (item) {\n                        return ctx.scope.schema.filter(item, fields);\n                    });\n                } else {\n                    ctx.result = ctx.scope.schema.filter(ctx.result, fields);\n                }\n                break;\n            case 'before':\n                var data = ctx.args.pop();\n                ctx.args = [ctx.scope.schema.filter(data, fields)].concat(_toConsumableArray(ctx.args));\n                break;\n        }\n        return Promise.resolve(ctx);\n    };\n}\n\nfunction formatFor(field, schema) {\n    return function (ctx) {\n        switch (ctx.hook) {\n            case 'after':\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isArray */])(ctx.result)) {\n                    ctx.result = ctx.result.map(function (item) {\n                        item[field] = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(item[field]) ? __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].format(item[field], schema.fieldSet) : schema.default();\n                        return item;\n                    });\n                } else {\n                    ctx.result[field] = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(ctx.result[field]) ? __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].format(ctx.result[field], schema.fieldSet) : schema.default();\n                }\n                break;\n            case 'before':\n                var data = ctx.args.pop();\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(data[field])) data[field] = __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].format(data[field], schema.fieldSet);else data[field] = schema.default();\n                ctx.args = [data].concat(_toConsumableArray(ctx.args));\n                break;\n        }\n        return Promise.resolve(ctx);\n    };\n}\n\nfunction filterFor(field, fields) {\n    return function (ctx) {\n        switch (ctx.hook) {\n            case 'after':\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isArray */])(ctx.result)) {\n                    ctx.result = ctx.result.map(function (item) {\n                        item[field] = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(item[field]) ? __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].filter(item[field], fields) : item[field];\n                        return item;\n                    });\n                } else {\n                    ctx.result[field] = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(ctx.result[field]) ? __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].filter(ctx.result[field], fields) : ctx.result[field];\n                }\n                break;\n            case 'before':\n                var data = ctx.args.pop();\n                if (Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(data[field])) data[field] = __WEBPACK_IMPORTED_MODULE_1__classes_Schema_class__[\"a\" /* default */].filter(data[field], fields);\n                ctx.args = [data].concat(_toConsumableArray(ctx.args));\n                break;\n        }\n        return Promise.resolve(ctx);\n    };\n}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Contact_class__ = __webpack_require__(5);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Model = function () {\n    function Model(options) {\n        _classCallCheck(this, Model);\n\n        var name = this._name = options.name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(name) || typeof name != 'string') {\n            throw new Error('options.name must be string in Model');\n        }\n        this._url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(options.url) ? options.url : '/' + name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isDef */])(options.contact) || options.contact.constructor != __WEBPACK_IMPORTED_MODULE_1__Contact_class__[\"a\" /* default */]) {\n            throw new Error('options.contact must be Contact class in Model');\n        }\n        this._contact = options.contact;\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\n    }\n\n    _createClass(Model, [{\n        key: 'fetch',\n        value: function fetch(params, opts) {\n            var _defaults = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults.origin;\n\n            return this.remote(origin).get(this._url, params);\n        }\n    }, {\n        key: 'find',\n        value: function find(id, opts) {\n            var _defaults2 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults2.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).get(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'save',\n        value: function save(data, opts) {\n            var _defaults3 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults3.origin;\n\n            var id = data.id;\n\n            var url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey);\n            return this.remote(origin)[Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"h\" /* isNew */])(data) ? 'post' : 'put'](url, data);\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id, opts) {\n            var _defaults4 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults4.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).delete(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'remote',\n        value: function remote(name) {\n            return this._contact.remote(name);\n        }\n    }, {\n        key: 'contact',\n        get: function get() {\n            return this._contact;\n        }\n    }]);\n\n    return Model;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Model);\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// dataplumber.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e30e81725df4a4984fce","import Method from '../classes/Method.class';\r\nimport Hooks from '../classes/Hooks.class';\r\n\r\nexport const isNew = data => !isDef(data.id);\r\nexport const getURL = (url, id, emulateIdKey) => emulateIdKey ? url : (url + (isDef(id) ? `/${id}` : ''));\r\nexport const isDef = val => typeof val !== 'undefined';\r\nexport const isArray = val => val.constructor === Array;\r\nexport const isNumber = val => val.constructor === Number;\r\nexport const defaults = (obj, defaults = {}) =>{\r\n    const merge = (defaults, obj) => defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\r\n    return isDef(obj) ? merge(defaults, obj) : defaults;\r\n};\r\n\r\nexport const compose = (...list) => acc => list.reduce((acc, fn) => acc.then(fn), Promise.resolve(acc));\r\n\r\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\r\nexport function convert(format = {}, options){\r\n    options = defaults(options, { format: false });\r\n    return (data = {}, fields = [].concat(Object.keys(data), Object.keys(format)))=>{\r\n        const result = {};\r\n        fields.forEach(fieldName => {\r\n            const fieldSet = format[fieldName];\r\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\r\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\r\n        });\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function formatField(to, defaultVal){\r\n    return val=>{\r\n        let result;\r\n        if(!isDef(val)) result = defaultVal;\r\n        else result = to(val);\r\n        if (defaultVal === result) return result;\r\n        if (isNumber(result) && result === NaN) result = defaultVal;\r\n        if (result === null) result = defaultVal;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function mapReceiveHook(methods, options){\r\n    options = defaults(options, Hooks.ReceiveBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapSendHook(methods, options) {\r\n    options = defaults(options, Hooks.SendBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapHooks(methods, options={}){\r\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\r\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\r\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\r\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\r\n    const result = options.methods.map(hookName => { return { [hookName]: {} } }).reduce(Object.assign);\r\n    Object.keys(result).forEach(hookName=>{\r\n        result[hookName] = options.hooks.map(hookName => { return { [hookName]: methods } }).reduce(Object.assign);\r\n    })\r\n    return result;\r\n}\r\n\r\nexport default {\r\n    isNew,\r\n    getURL,\r\n    isDef,\r\n    defaults,\r\n    convert,\r\n    compose,\r\n    mapSendHook,\r\n    mapReceiveHook\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","class Hooks {\r\n    constructor() {\r\n        this._map = new Map();\r\n    }\r\n    addHooks(key, operations) {\r\n        return this._map.set(key, operations);\r\n    }\r\n    getHooks(key) {\r\n        return this._map.get(key);\r\n    }\r\n    each(fn) {\r\n        return this._map.forEach(fn);\r\n    }\r\n    get length() {\r\n        return this._map.size;\r\n    }\r\n\r\n    static parse({ method, hook }, type = 'method'){\r\n        let result = `${method}:${hook}`;\r\n        if (type === 'behaviour') {\r\n            if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\r\n            if (Hooks.isSendBehaviour(method, hook)) result = 'send';\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static get ReceiveBehaviour(){\r\n        return {\r\n            methods: ['fetch','find'],\r\n            hooks: ['after']\r\n        }\r\n    }\r\n    static get SendBehaviour() {\r\n        return {\r\n            methods: ['save'],\r\n            hooks: ['before']\r\n        }\r\n    }\r\n\r\n    static isReceiveBehaviour(method, hook){\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\r\n        return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n\r\n    static isSendBehaviour(method, hook) {\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\r\n        return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n}\r\n\r\nexport default Hooks;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Hooks.class.js","// import compose from 'koa-compose';\r\nimport { defaults, compose } from '../utils/';\r\n\r\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\r\n\r\nclass Method {\r\n    static generate(queues) {\r\n        const queue = compose(...queues);\r\n        return (args, ctx={}) => {\r\n            ctx = Object.assign(ctx, {args});\r\n            return new Promise((resolve, reject) => {\r\n                queue(ctx)\r\n                    .then(ctx=>resolve(ctx.result))\r\n                    .catch(reject);\r\n            });\r\n        }\r\n    }\r\n    static concat(...args){\r\n        return args.map(arg => defaults(arg, [])).reduce((x,y)=>x.concat(y));\r\n    }\r\n}\r\n\r\nexport default Method;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Method.class.js","import { convert } from \"../utils/\";\r\n\r\nexport const format = (data, fieldSet) => convert(fieldSet, { format:true })(data);\r\nexport const filter = (data, fields) => convert()(data, fields);\r\nexport const schema = fieldSet => convert(fieldSet, { format: true })({}, Object.keys(fieldSet));\r\n\r\nexport default class Schema {\r\n    constructor(fieldSet) {\r\n        this._fieldSet = fieldSet;\r\n    }\r\n    format(data) {\r\n        return format(data, this._fieldSet);\r\n    }\r\n    filter(data, fields = Object.keys(this._fieldSet)){\r\n        return filter(data, fields);\r\n    }\r\n    default(){\r\n        return schema(this._fieldSet);\r\n    }\r\n    get fieldSet() {\r\n        return this._fieldSet;\r\n    }\r\n\r\n    // static\r\n    static format(data, fieldSet){\r\n        return format(data, fieldSet);\r\n    }\r\n    static filter(data, fields) {\r\n        return filter(data, fields);\r\n    }\r\n    static default(fieldSet) {\r\n        return schema(fieldSet);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Schema.class.js","import utils from './utils/';\r\nimport Model from './classes/Model.class';\r\nimport Hooks from './classes/Hooks.class';\r\nimport Contact from './classes/Contact.class';\r\nimport Remote from './classes/Remote.class';\r\nimport Schema from './classes/Schema.class';\r\nimport Method from './classes/Method.class';\r\n\r\nexport function ModelFactory(options) {\r\n    const schema = new Schema(options.fields);\r\n    const methods = {\r\n        'fetch': Model.prototype.fetch,\r\n        'find': Model.prototype.find,\r\n        'save': Model.prototype.save,\r\n        'delete': Model.prototype.delete,\r\n        ...options.methods\r\n    }\r\n    //RichModel\r\n    class RichModel extends Model{\r\n        constructor(opts){\r\n            opts = utils.defaults(opts);\r\n            opts.name = options.name;\r\n            super(opts);\r\n            this.initHooks(options.hooks);\r\n        }\r\n        initHooks(options){\r\n            this._hooks = HooksFactory(options);\r\n        }\r\n        get schema(){\r\n            return schema;\r\n        }\r\n        static get schema(){\r\n            return schema;\r\n        }\r\n    }\r\n    Object\r\n        .keys(methods)\r\n        .forEach(methodName => {\r\n            // all hook action magic in here.\r\n            RichModel.prototype[methodName] = function (...args){\r\n                const opts = utils.defaults(args[args.length-1]);\r\n                const hooks = utils.defaults(opts.hooks, { before: [], after: [] });\r\n\r\n                const before = Method.concat(hooks.before, this._hooks.getHooks(`${methodName}::before`));\r\n                const after = Method.concat(hooks.after, this._hooks.getHooks(`${methodName}::after`));\r\n\r\n                const method = (ctx) => methods[methodName].apply(ctx.scope, ctx.args).then(data => {\r\n                    ctx.hook = 'after';\r\n                    ctx.result = data;\r\n                    return Promise.resolve(ctx);\r\n                });\r\n                const ctx = { scope: this, method: methodName, hook: 'before' };\r\n\r\n                return Method.generate([...before, method, ...after])(args, ctx);\r\n            }\r\n        });\r\n\r\n    return RichModel;\r\n}\r\n\r\nexport function ContactFactory(remotes = {}, defaults) {\r\n    const contact = new Contact();\r\n    Object.keys(remotes).forEach((remoteName, index) => {\r\n        contact.remote(remoteName, new Remote({ origin: remotes[remoteName] }), { default: index == 0 });\r\n    })\r\n    if (defaults) contact.default(defaults);\r\n    return contact;\r\n}\r\n\r\nexport function HooksFactory(options){\r\n    const hooks = new Hooks();\r\n    //解析hooks的逻辑，并添加hook记录\r\n    \r\n    Object\r\n        .keys(utils.defaults(options))\r\n        .forEach(hookName=>{\r\n            const hook = options[hookName];\r\n            Object.keys(hook).forEach(aboutName=>{\r\n                hooks.addHooks(`${hookName}::${aboutName}`, hook[aboutName]);\r\n            })\r\n        });\r\n\r\n    return hooks;\r\n}\r\n\r\nexport default {\r\n    Model: ModelFactory,\r\n    Contact: ContactFactory,\r\n    Hooks: HooksFactory\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/DataPlumber.js","import Remote from './Remote.class';\r\nimport { defaults } from '../utils/';\r\n\r\nexport default class Contact {\r\n    constructor() {\r\n        this._remotes = {};\r\n        this._default_remote = \"\";\r\n    }\r\n    remote(...args) {\r\n        let name = args[0],\r\n            remote = args[1],\r\n            opts = defaults(args[2], { default: false });\r\n        if (args.length >= 2) {\r\n            // set remote\r\n            if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\r\n            if (remote.constructor !== Remote) throw new TypeError('The second arguments must be Remote');\r\n            this._remotes[name] = remote;\r\n            if (opts.default || this.length == 1) this.default(name);\r\n        } else {\r\n            name = name ? name : this._default_remote;\r\n            if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in remote()`);\r\n            // get remote\r\n            remote = this._remotes[name];\r\n            return remote;\r\n        }\r\n    }\r\n    default(name) {\r\n        if(typeof name !== 'string') throw new TypeError('The name must be string in default()');\r\n        if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in default()`);\r\n        this._default_remote = name;\r\n    }\r\n    has(name) {\r\n        return Object.keys(this._remotes).indexOf(name) !== -1;\r\n    }\r\n    get length() {\r\n        return Object.keys(this._remotes).length;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Contact.class.js","export default class Remote {\r\n    constructor(options) {\r\n        this._origin = options.origin;\r\n    }\r\n    get(url, params) {\r\n        return this.sync({\r\n            url,\r\n            method: 'GET',\r\n            params\r\n        });\r\n    }\r\n    post(url, data) {\r\n        return this.sync({\r\n            method: 'POST',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    put(url, data) {\r\n        return this.sync({\r\n            method: 'PUT',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    patch(url, data) {\r\n        return this.sync({\r\n            method: 'PATCH',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    delete(url, data) {\r\n        return this.sync({\r\n            method: 'DELETE',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    sync(options){\r\n        return this._origin(options);\r\n    }\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Remote.class.js","export * from './operations/';\r\nexport * from './DataPlumber';\r\n\r\nimport { mapReceiveHook, mapSendHook } from './utils/';\r\nimport DataPlumber from './DataPlumber';\r\nexport {\r\n    mapReceiveHook,\r\n    mapSendHook\r\n}\r\nexport default {\r\n    ...DataPlumber,\r\n    mapReceiveHook,\r\n    mapSendHook\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import { defaults, isDef, isArray } from \"../utils/\";\r\nimport Schema from \"../classes/Schema.class\";\r\nimport Hooks from \"../classes/Hooks.class\";\r\n\r\nexport function requestData() {\r\n    return (ctx)=>{\r\n        const res = ctx.result;\r\n        if(res.status < 200){\r\n            const err = new Error(res.message);\r\n            err.respose = res.response;\r\n            throw err\r\n        };\r\n        ctx.result = res.data;\r\n        return Promise.resolve(ctx);\r\n    }\r\n}\r\n\r\nexport function awaitTo(promise) {\r\n    return promise.then(data => {\r\n        return [null, data];\r\n    }).catch(err => [err]);\r\n}\r\n\r\nexport function format() {\r\n    return (ctx) => {\r\n        switch (ctx.hook) {\r\n            case 'after':\r\n                if (isDef(ctx.result) && isArray(ctx.result)){\r\n                    ctx.result = ctx.result.map(item => ctx.scope.schema.format(item));\r\n                }else{\r\n                    ctx.result = ctx.scope.schema.format(ctx.result);\r\n                }\r\n                break;\r\n            case 'before':\r\n                const data = ctx.args.pop();\r\n                ctx.args = [ctx.scope.schema.format(data), ...ctx.args];\r\n                break;\r\n        }\r\n        return Promise.resolve(ctx);\r\n    }\r\n}\r\n\r\nexport function filter(fields){\r\n    return (ctx) => {\r\n        switch (ctx.hook) {\r\n            case 'after':\r\n                if (isDef(ctx.result) && isArray(ctx.result)) {\r\n                    ctx.result = ctx.result.map(item => ctx.scope.schema.filter(item, fields));\r\n                } else {\r\n                    ctx.result = ctx.scope.schema.filter(ctx.result, fields);\r\n                }\r\n                break;\r\n            case 'before':\r\n                const data = ctx.args.pop();\r\n                ctx.args = [ctx.scope.schema.filter(data, fields), ...ctx.args];\r\n                break;\r\n        }\r\n        return Promise.resolve(ctx);\r\n    }\r\n}\r\n\r\nexport function formatFor(field, schema){\r\n    return (ctx) => {\r\n        switch (ctx.hook) {\r\n            case 'after':\r\n                if (isArray(ctx.result)){\r\n                    ctx.result = ctx.result.map(item =>{\r\n                        item[field] = isDef(item[field]) ? Schema.format(item[field], schema.fieldSet) : schema.default();\r\n                        return item;\r\n                    });\r\n                }else{\r\n                    ctx.result[field] = isDef(ctx.result[field]) ? Schema.format(ctx.result[field], schema.fieldSet) : schema.default();\r\n                }\r\n                break;\r\n            case 'before':\r\n                const data = ctx.args.pop();\r\n                if (isDef(data[field])) data[field] = Schema.format(data[field], schema.fieldSet);\r\n                else data[field] = schema.default();\r\n                ctx.args = [data, ...ctx.args];\r\n                break;\r\n        }\r\n        return Promise.resolve(ctx);\r\n    }\r\n}\r\n\r\nexport function filterFor(field, fields) {\r\n    return (ctx) => {\r\n        switch (ctx.hook) {\r\n            case 'after':\r\n                if (isArray(ctx.result)) {\r\n                    ctx.result = ctx.result.map(item => {\r\n                        item[field] = isDef(item[field]) ? Schema.filter(item[field], fields) : item[field];\r\n                        return item;\r\n                    });\r\n                } else {\r\n                    ctx.result[field] = isDef(ctx.result[field]) ? Schema.filter(ctx.result[field], fields) : ctx.result[field];\r\n                }\r\n                break;\r\n            case 'before':\r\n                const data = ctx.args.pop();\r\n                if (isDef(data[field])) data[field] = Schema.filter(data[field], fields);\r\n                ctx.args = [data, ...ctx.args];\r\n                break;\r\n        }\r\n        return Promise.resolve(ctx);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/operations/index.js","import { isNew, getURL, defaults, isDef } from \"../utils/\";\r\nimport Contact from './Contact.class';\r\n\r\nexport default class Model {\r\n    constructor(options) {\r\n        const name = this._name = options.name;\r\n        if(!isDef(name) || typeof name != 'string'){\r\n            throw new Error('options.name must be string in Model');\r\n        }\r\n        this._url = isDef(options.url) ? options.url : `/${name}`;\r\n        if (!isDef(options.contact) || options.contact.constructor != Contact){\r\n            throw new Error('options.contact must be Contact class in Model');\r\n        }\r\n        this._contact = options.contact;\r\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\r\n    }\r\n    fetch(params, opts) {\r\n        const { origin } = defaults(opts);\r\n        return this.remote(origin).get(this._url, params);\r\n    }\r\n    find(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).get(getURL(this._url, id, this._emulateIdKey), params );\r\n    }\r\n    save(data, opts) {\r\n        const { origin } = defaults(opts);\r\n        const { id } = data;\r\n        const url = getURL(this._url, id, this._emulateIdKey);\r\n        return this.remote(origin)[isNew(data) ? 'post' : 'put'](url, data);\r\n    }\r\n    delete(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).delete(getURL(this._url, id, this._emulateIdKey), params);\r\n    }\r\n    remote(name) {\r\n        return this._contact.remote(name);\r\n    }\r\n    get contact(){\r\n        return this._contact;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Model.class.js"],"sourceRoot":""}