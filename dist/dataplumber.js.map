{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dataplumber.js","webpack:///webpack/bootstrap b4e0c9e084c696f31950","webpack:///./src/utils/index.js","webpack:///./src/classes/Method.class.js","webpack:///./src/classes/Hooks.class.js","webpack:///./src/classes/Contact.class.js","webpack:///./src/classes/Remote.class.js","webpack:///./src/index.js","webpack:///./src/DataPlumber.js","webpack:///./src/classes/Model.class.js","webpack:///./src/classes/Schema.class.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","_defineProperty","obj","key","value","writable","convert","format","arguments","length","undefined","options","defaults","data","fields","concat","keys","result","forEach","fieldName","fieldSet","isDef","formatField","type","default","to","defaultVal","val","isNumber","NaN","mapReceiveHook","methods","__WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__","ReceiveBehaviour","mapHooks","mapSendHook","SendBehaviour","Error","isArray","hooks","map","hookName","reduce","assign","isNew","getURL","compose","id","url","emulateIdKey","constructor","Array","Number","_len","list","_key","acc","fn","then","Promise","resolve","_toConsumableArray","arr","arr2","from","_classCallCheck","instance","Constructor","TypeError","__WEBPACK_IMPORTED_MODULE_0__utils___","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","Method","queues","queue","args","ctx","reject","catch","arg","x","y","Hooks","_map","Map","operations","set","size","_ref","method","hook","isReceiveBehaviour","isSendBehaviour","indexOf","__WEBPACK_IMPORTED_MODULE_0__Remote_class__","__WEBPACK_IMPORTED_MODULE_1__utils___","Contact","_remotes","_default_remote","remote","opts","has","RangeError","Remote","_origin","origin","params","sync","__WEBPACK_IMPORTED_MODULE_0__DataPlumber__","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","ModelFactory","schema","__WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__","fetch","__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__","find","save","delete","RichModel","_Model","_this","getPrototypeOf","initHooks","_hooks","HooksFactory","methodName","before","after","__WEBPACK_IMPORTED_MODULE_6__classes_Method_class__","getHooks","apply","scope","generate","ContactFactory","remotes","contact","__WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__","remoteName","index","__WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__","__WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__","aboutName","addHooks","_extends","source","DataPlumber","Model","Schema","__WEBPACK_IMPORTED_MODULE_1__Contact_class__","_name","_url","_contact","_emulateIdKey","_defaults","_defaults2","_defaults3","_defaults4","filter","_fieldSet"],"mappings":"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","file":"dataplumber.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dataplumber\"] = factory();\n\telse\n\t\troot[\"dataplumber\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dataplumber\"] = factory();\n\telse\n\t\troot[\"dataplumber\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return isNew; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return getURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return isDef; });\n/* unused harmony export isArray */\n/* unused harmony export isNumber */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return defaults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return compose; });\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = convert;\n/* unused harmony export formatField */\n/* unused harmony export mapReceiveHook */\n/* unused harmony export mapSendHook */\n/* unused harmony export mapHooks */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__classes_Method_class__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__ = __webpack_require__(2);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nvar isNew = function isNew(data) {\n    return !isDef(data.id);\n};\nvar getURL = function getURL(url, id, emulateIdKey) {\n    return emulateIdKey ? url : url + (isDef(id) ? '/' + id : '');\n};\nvar isDef = function isDef(val) {\n    return typeof val !== 'undefined';\n};\nvar isArray = function isArray(val) {\n    return val.constructor === Array;\n};\nvar isNumber = function isNumber(val) {\n    return val.constructor === Number;\n};\nvar defaults = function defaults(obj) {\n    var defaults = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var merge = function merge(defaults, obj) {\n        return defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\n    };\n    return isDef(obj) ? merge(defaults, obj) : defaults;\n};\n\nvar compose = function compose() {\n    for (var _len = arguments.length, list = Array(_len), _key = 0; _key < _len; _key++) {\n        list[_key] = arguments[_key];\n    }\n\n    return function (acc) {\n        return list.reduce(function (acc, fn) {\n            return acc.then(fn);\n        }, Promise.resolve(acc));\n    };\n};\n\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\nfunction convert() {\n    var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var options = arguments[1];\n\n    options = defaults(options, { format: false });\n    return function () {\n        var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [].concat(Object.keys(data), Object.keys(format));\n\n        var result = {};\n        fields.forEach(function (fieldName) {\n            var fieldSet = format[fieldName];\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\n        });\n        return result;\n    };\n}\n\nfunction formatField(to, defaultVal) {\n    return function (val) {\n        var result = void 0;\n        if (!isDef(val)) result = defaultVal;else result = to(val);\n        if (defaultVal === result) return result;\n        if (isNumber(result) && result === NaN) result = defaultVal;\n        if (result === null) result = defaultVal;\n        return result;\n    };\n}\n\nfunction mapReceiveHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].ReceiveBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapSendHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].SendBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapHooks(methods) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\n    var result = options.methods.map(function (hookName) {\n        return _defineProperty({}, hookName, {});\n    }).reduce(Object.assign);\n    Object.keys(result).forEach(function (hookName) {\n        result[hookName] = options.hooks.map(function (hookName) {\n            return _defineProperty({}, hookName, methods);\n        }).reduce(Object.assign);\n    });\n    return result;\n}\n\n/* harmony default export */ __webpack_exports__[\"c\"] = ({\n    isNew: isNew,\n    getURL: getURL,\n    isDef: isDef,\n    defaults: defaults,\n    convert: convert,\n    compose: compose,\n    mapSendHook: mapSendHook,\n    mapReceiveHook: mapReceiveHook\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// import compose from 'koa-compose';\n\n\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\n\nvar Method = function () {\n    function Method() {\n        _classCallCheck(this, Method);\n    }\n\n    _createClass(Method, null, [{\n        key: 'generate',\n        value: function generate(queues) {\n            var queue = __WEBPACK_IMPORTED_MODULE_0__utils___[\"a\" /* compose */].apply(undefined, _toConsumableArray(queues));\n            return function (args) {\n                var ctx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n                ctx = Object.assign(ctx, { args: args });\n                return new Promise(function (resolve, reject) {\n                    queue(ctx).then(function (ctx) {\n                        return resolve(ctx.result);\n                    }).catch(reject);\n                });\n            };\n        }\n    }, {\n        key: 'concat',\n        value: function concat() {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            return args.map(function (arg) {\n                return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(arg, []);\n            }).reduce(function (x, y) {\n                return x.concat(y);\n            });\n        }\n    }]);\n\n    return Method;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Method);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Hooks = function () {\n    function Hooks() {\n        _classCallCheck(this, Hooks);\n\n        this._map = new Map();\n    }\n\n    _createClass(Hooks, [{\n        key: 'addHooks',\n        value: function addHooks(key, operations) {\n            return this._map.set(key, operations);\n        }\n    }, {\n        key: 'getHooks',\n        value: function getHooks(key) {\n            return this._map.get(key);\n        }\n    }, {\n        key: 'each',\n        value: function each(fn) {\n            return this._map.forEach(fn);\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return this._map.size;\n        }\n    }], [{\n        key: 'parse',\n        value: function parse(_ref) {\n            var method = _ref.method,\n                hook = _ref.hook;\n            var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'method';\n\n            var result = method + ':' + hook;\n            if (type === 'behaviour') {\n                if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\n                if (Hooks.isSendBehaviour(method, hook)) result = 'send';\n            }\n            return result;\n        }\n    }, {\n        key: 'isReceiveBehaviour',\n        value: function isReceiveBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\n            return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'isSendBehaviour',\n        value: function isSendBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\n            return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'ReceiveBehaviour',\n        get: function get() {\n            return {\n                methods: ['fetch', 'find'],\n                hooks: ['after']\n            };\n        }\n    }, {\n        key: 'SendBehaviour',\n        get: function get() {\n            return {\n                methods: ['save'],\n                hooks: ['before']\n            };\n        }\n    }]);\n\n    return Hooks;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Hooks);\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Remote_class__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Contact = function () {\n    function Contact() {\n        _classCallCheck(this, Contact);\n\n        this._remotes = {};\n        this._default_remote = \"\";\n    }\n\n    _createClass(Contact, [{\n        key: 'remote',\n        value: function remote() {\n            var name = arguments.length <= 0 ? undefined : arguments[0],\n                remote = arguments.length <= 1 ? undefined : arguments[1],\n                opts = Object(__WEBPACK_IMPORTED_MODULE_1__utils___[\"d\" /* defaults */])(arguments.length <= 2 ? undefined : arguments[2], { default: false });\n            if (arguments.length >= 2) {\n                // set remote\n                if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\n                if (remote.constructor !== __WEBPACK_IMPORTED_MODULE_0__Remote_class__[\"a\" /* default */]) throw new TypeError('The second arguments must be Remote');\n                this._remotes[name] = remote;\n                if (opts.default || this.length == 1) this.default(name);\n            } else {\n                name = name ? name : this._default_remote;\n                if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in remote()');\n                // get remote\n                remote = this._remotes[name];\n                return remote;\n            }\n        }\n    }, {\n        key: 'default',\n        value: function _default(name) {\n            if (typeof name !== 'string') throw new TypeError('The name must be string in default()');\n            if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in default()');\n            this._default_remote = name;\n        }\n    }, {\n        key: 'has',\n        value: function has(name) {\n            return Object.keys(this._remotes).indexOf(name) !== -1;\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return Object.keys(this._remotes).length;\n        }\n    }]);\n\n    return Contact;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Contact);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Remote = function () {\n    function Remote(options) {\n        _classCallCheck(this, Remote);\n\n        this._origin = options.origin;\n    }\n\n    _createClass(Remote, [{\n        key: 'get',\n        value: function get(url, params) {\n            return this.sync({\n                url: url,\n                method: 'GET',\n                params: params\n            });\n        }\n    }, {\n        key: 'post',\n        value: function post(url, data) {\n            return this.sync({\n                method: 'POST',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'put',\n        value: function put(url, data) {\n            return this.sync({\n                method: 'PUT',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'patch',\n        value: function patch(url, data) {\n            return this.sync({\n                method: 'PATCH',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(url, data) {\n            return this.sync({\n                method: 'DELETE',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'sync',\n        value: function sync(options) {\n            return this._origin(options);\n        }\n    }, {\n        key: 'origin',\n        get: function get() {\n            return this._origin;\n        }\n    }]);\n\n    return Remote;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Remote);\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__DataPlumber__ = __webpack_require__(6);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (__WEBPACK_IMPORTED_MODULE_0__DataPlumber__[\"a\" /* default */]);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export ModelFactory */\n/* unused harmony export ContactFactory */\n/* unused harmony export HooksFactory */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__ = __webpack_require__(1);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\n\n\nfunction ModelFactory(options) {\n    var schema = new __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__[\"a\" /* default */](options.fields);\n    var methods = _extends({\n        'fetch': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.fetch,\n        'find': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.find,\n        'save': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.save,\n        'delete': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.delete\n    }, options.methods);\n    //RichModel\n\n    var RichModel = function (_Model) {\n        _inherits(RichModel, _Model);\n\n        function RichModel(opts) {\n            _classCallCheck(this, RichModel);\n\n            opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts);\n            opts.name = options.name;\n\n            var _this = _possibleConstructorReturn(this, (RichModel.__proto__ || Object.getPrototypeOf(RichModel)).call(this, opts));\n\n            _this.initHooks(options.hooks);\n            return _this;\n        }\n\n        _createClass(RichModel, [{\n            key: 'initHooks',\n            value: function initHooks(options) {\n                this._hooks = HooksFactory(options);\n            }\n        }, {\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }], [{\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }]);\n\n        return RichModel;\n    }(__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */]);\n\n    Object.keys(methods).forEach(function (methodName) {\n        // all hook action magic in here.\n        RichModel.prototype[methodName] = function () {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            var opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(args[args.length - 1]);\n            var hooks = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts.hooks, { before: [], after: [] });\n\n            var before = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.before, this._hooks.getHooks(methodName + '::before'));\n            var after = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.after, this._hooks.getHooks(methodName + '::after'));\n\n            var method = function method(ctx) {\n                return methods[methodName].apply(ctx.scope, ctx.args).then(function (data) {\n                    ctx.hook = 'after';\n                    ctx.result = data;\n                    return Promise.resolve(ctx);\n                });\n            };\n            var ctx = { scope: this, method: methodName, hook: 'before' };\n\n            return __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].generate([].concat(_toConsumableArray(before), [method], _toConsumableArray(after)))(args, ctx);\n        };\n    });\n\n    return RichModel;\n}\n\nfunction ContactFactory() {\n    var remotes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var defaults = arguments[1];\n\n    var contact = new __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__[\"a\" /* default */]();\n    Object.keys(remotes).forEach(function (remoteName, index) {\n        contact.remote(remoteName, new __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__[\"a\" /* default */]({ origin: remotes[remoteName] }), { default: index == 0 });\n    });\n    if (defaults) contact.default(defaults);\n    return contact;\n}\n\nfunction HooksFactory(options) {\n    var hooks = new __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__[\"a\" /* default */]();\n    //解析hooks的逻辑，并添加hook记录\n\n    Object.keys(__WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(options)).forEach(function (hookName) {\n        var hook = options[hookName];\n        Object.keys(hook).forEach(function (aboutName) {\n            hooks.addHooks(hookName + '::' + aboutName, hook[aboutName]);\n        });\n    });\n\n    return hooks;\n}\n\nvar DataPlumber = {\n    Contact: ContactFactory,\n    Model: ModelFactory,\n    Hooks: HooksFactory,\n    Schema: __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__[\"a\" /* default */],\n    mapReceiveHook: __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].mapReceiveHook,\n    mapSendHook: __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].mapSendHook,\n    operations: __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */]\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DataPlumber);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Contact_class__ = __webpack_require__(3);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Model = function () {\n    function Model(options) {\n        _classCallCheck(this, Model);\n\n        var name = this._name = options.name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(name) || typeof name != 'string') {\n            throw new Error('options.name must be string in Model');\n        }\n        this._url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(options.url) ? options.url : '/' + name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(options.contact) || options.contact.constructor != __WEBPACK_IMPORTED_MODULE_1__Contact_class__[\"a\" /* default */]) {\n            throw new Error('options.contact must be Contact class in Model');\n        }\n        this._contact = options.contact;\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\n    }\n\n    _createClass(Model, [{\n        key: 'fetch',\n        value: function fetch(params, opts) {\n            var _defaults = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults.origin;\n\n            return this.remote(origin).get(this._url, params);\n        }\n    }, {\n        key: 'find',\n        value: function find(id, opts) {\n            var _defaults2 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults2.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).get(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'save',\n        value: function save(data, opts) {\n            var _defaults3 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults3.origin;\n\n            var id = data.id;\n\n            var url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey);\n            return this.remote(origin)[Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isNew */])(data) ? 'post' : 'put'](url, data);\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id, opts) {\n            var _defaults4 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults4.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).delete(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'remote',\n        value: function remote(name) {\n            return this._contact.remote(name);\n        }\n    }, {\n        key: 'contact',\n        get: function get() {\n            return this._contact;\n        }\n    }]);\n\n    return Model;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Model);\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export format */\n/* unused harmony export filter */\n/* unused harmony export schema */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar _format = function _format(data, fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })(data);\n};\n\nvar _filter = function _filter(data, fields) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])()(data, fields);\n};\n\nvar schema = function schema(fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })({}, Object.keys(fieldSet));\n};\n\nvar Schema = function () {\n    function Schema(fieldSet) {\n        _classCallCheck(this, Schema);\n\n        this._fieldSet = fieldSet;\n    }\n\n    _createClass(Schema, [{\n        key: \"format\",\n        value: function format(data) {\n            return _format(data, this._fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data) {\n            var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Object.keys(this._fieldSet);\n\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default() {\n            return schema(this._fieldSet);\n        }\n    }, {\n        key: \"fieldSet\",\n        get: function get() {\n            return this._fieldSet;\n        }\n\n        // static\n\n    }], [{\n        key: \"format\",\n        value: function format(data, fieldSet) {\n            return _format(data, fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data, fields) {\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default(fieldSet) {\n            return schema(fieldSet);\n        }\n    }]);\n\n    return Schema;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Schema);\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// dataplumber.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b4e0c9e084c696f31950","import Method from '../classes/Method.class';\r\nimport Hooks from '../classes/Hooks.class';\r\n\r\nexport const isNew = data => !isDef(data.id);\r\nexport const getURL = (url, id, emulateIdKey) => emulateIdKey ? url : (url + (isDef(id) ? `/${id}` : ''));\r\nexport const isDef = val => typeof val !== 'undefined';\r\nexport const isArray = val => val.constructor === Array;\r\nexport const isNumber = val => val.constructor === Number;\r\nexport const defaults = (obj, defaults = {}) =>{\r\n    const merge = (defaults, obj) => defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\r\n    return isDef(obj) ? merge(defaults, obj) : defaults;\r\n};\r\n\r\nexport const compose = (...list) => acc => list.reduce((acc, fn) => acc.then(fn), Promise.resolve(acc));\r\n\r\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\r\nexport function convert(format = {}, options){\r\n    options = defaults(options, { format: false });\r\n    return (data = {}, fields = [].concat(Object.keys(data), Object.keys(format)))=>{\r\n        const result = {};\r\n        fields.forEach(fieldName => {\r\n            const fieldSet = format[fieldName];\r\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\r\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\r\n        });\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function formatField(to, defaultVal){\r\n    return val=>{\r\n        let result;\r\n        if(!isDef(val)) result = defaultVal;\r\n        else result = to(val);\r\n        if (defaultVal === result) return result;\r\n        if (isNumber(result) && result === NaN) result = defaultVal;\r\n        if (result === null) result = defaultVal;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function mapReceiveHook(methods, options){\r\n    options = defaults(options, Hooks.ReceiveBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapSendHook(methods, options) {\r\n    options = defaults(options, Hooks.SendBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapHooks(methods, options={}){\r\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\r\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\r\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\r\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\r\n    const result = options.methods.map(hookName => { return { [hookName]: {} } }).reduce(Object.assign);\r\n    Object.keys(result).forEach(hookName=>{\r\n        result[hookName] = options.hooks.map(hookName => { return { [hookName]: methods } }).reduce(Object.assign);\r\n    })\r\n    return result;\r\n}\r\n\r\nexport default {\r\n    isNew,\r\n    getURL,\r\n    isDef,\r\n    defaults,\r\n    convert,\r\n    compose,\r\n    mapSendHook,\r\n    mapReceiveHook\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","// import compose from 'koa-compose';\r\nimport { defaults, compose } from '../utils/';\r\n\r\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\r\n\r\nclass Method {\r\n    static generate(queues) {\r\n        const queue = compose(...queues);\r\n        return (args, ctx={}) => {\r\n            ctx = Object.assign(ctx, {args});\r\n            return new Promise((resolve, reject) => {\r\n                queue(ctx)\r\n                    .then(ctx=>resolve(ctx.result))\r\n                    .catch(reject);\r\n            });\r\n        }\r\n    }\r\n    static concat(...args){\r\n        return args.map(arg => defaults(arg, [])).reduce((x,y)=>x.concat(y));\r\n    }\r\n}\r\n\r\nexport default Method;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Method.class.js","class Hooks {\r\n    constructor() {\r\n        this._map = new Map();\r\n    }\r\n    addHooks(key, operations) {\r\n        return this._map.set(key, operations);\r\n    }\r\n    getHooks(key) {\r\n        return this._map.get(key);\r\n    }\r\n    each(fn) {\r\n        return this._map.forEach(fn);\r\n    }\r\n    get length() {\r\n        return this._map.size;\r\n    }\r\n\r\n    static parse({ method, hook }, type = 'method'){\r\n        let result = `${method}:${hook}`;\r\n        if (type === 'behaviour') {\r\n            if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\r\n            if (Hooks.isSendBehaviour(method, hook)) result = 'send';\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static get ReceiveBehaviour(){\r\n        return {\r\n            methods: ['fetch','find'],\r\n            hooks: ['after']\r\n        }\r\n    }\r\n    static get SendBehaviour() {\r\n        return {\r\n            methods: ['save'],\r\n            hooks: ['before']\r\n        }\r\n    }\r\n\r\n    static isReceiveBehaviour(method, hook){\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\r\n        return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n\r\n    static isSendBehaviour(method, hook) {\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\r\n        return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n}\r\n\r\nexport default Hooks;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Hooks.class.js","import Remote from './Remote.class';\r\nimport { defaults } from '../utils/';\r\n\r\nexport default class Contact {\r\n    constructor() {\r\n        this._remotes = {};\r\n        this._default_remote = \"\";\r\n    }\r\n    remote(...args) {\r\n        let name = args[0],\r\n            remote = args[1],\r\n            opts = defaults(args[2], { default: false });\r\n        if (args.length >= 2) {\r\n            // set remote\r\n            if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\r\n            if (remote.constructor !== Remote) throw new TypeError('The second arguments must be Remote');\r\n            this._remotes[name] = remote;\r\n            if (opts.default || this.length == 1) this.default(name);\r\n        } else {\r\n            name = name ? name : this._default_remote;\r\n            if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in remote()`);\r\n            // get remote\r\n            remote = this._remotes[name];\r\n            return remote;\r\n        }\r\n    }\r\n    default(name) {\r\n        if(typeof name !== 'string') throw new TypeError('The name must be string in default()');\r\n        if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in default()`);\r\n        this._default_remote = name;\r\n    }\r\n    has(name) {\r\n        return Object.keys(this._remotes).indexOf(name) !== -1;\r\n    }\r\n    get length() {\r\n        return Object.keys(this._remotes).length;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Contact.class.js","export default class Remote {\r\n    constructor(options) {\r\n        this._origin = options.origin;\r\n    }\r\n    get(url, params) {\r\n        return this.sync({\r\n            url,\r\n            method: 'GET',\r\n            params\r\n        });\r\n    }\r\n    post(url, data) {\r\n        return this.sync({\r\n            method: 'POST',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    put(url, data) {\r\n        return this.sync({\r\n            method: 'PUT',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    patch(url, data) {\r\n        return this.sync({\r\n            method: 'PATCH',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    delete(url, data) {\r\n        return this.sync({\r\n            method: 'DELETE',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    sync(options){\r\n        return this._origin(options);\r\n    }\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Remote.class.js","import DataPlumber from './DataPlumber';\r\nexport default DataPlumber;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import utils from './utils/';\r\nimport operations from './utils/';\r\nimport Model from './classes/Model.class';\r\nimport Hooks from './classes/Hooks.class';\r\nimport Contact from './classes/Contact.class';\r\nimport Remote from './classes/Remote.class';\r\nimport Schema from './classes/Schema.class';\r\nimport Method from './classes/Method.class';\r\n\r\nexport function ModelFactory(options) {\r\n    const schema = new Schema(options.fields);\r\n    const methods = {\r\n        'fetch': Model.prototype.fetch,\r\n        'find': Model.prototype.find,\r\n        'save': Model.prototype.save,\r\n        'delete': Model.prototype.delete,\r\n        ...options.methods\r\n    }\r\n    //RichModel\r\n    class RichModel extends Model{\r\n        constructor(opts){\r\n            opts = utils.defaults(opts);\r\n            opts.name = options.name;\r\n            super(opts);\r\n            this.initHooks(options.hooks);\r\n        }\r\n        initHooks(options){\r\n            this._hooks = HooksFactory(options);\r\n        }\r\n        get schema(){\r\n            return schema;\r\n        }\r\n        static get schema(){\r\n            return schema;\r\n        }\r\n    }\r\n    Object\r\n        .keys(methods)\r\n        .forEach(methodName => {\r\n            // all hook action magic in here.\r\n            RichModel.prototype[methodName] = function (...args){\r\n                const opts = utils.defaults(args[args.length-1]);\r\n                const hooks = utils.defaults(opts.hooks, { before: [], after: [] });\r\n\r\n                const before = Method.concat(hooks.before, this._hooks.getHooks(`${methodName}::before`));\r\n                const after = Method.concat(hooks.after, this._hooks.getHooks(`${methodName}::after`));\r\n\r\n                const method = (ctx) => methods[methodName].apply(ctx.scope, ctx.args).then(data => {\r\n                    ctx.hook = 'after';\r\n                    ctx.result = data;\r\n                    return Promise.resolve(ctx);\r\n                });\r\n                const ctx = { scope: this, method: methodName, hook: 'before' };\r\n\r\n                return Method.generate([...before, method, ...after])(args, ctx);\r\n            }\r\n        });\r\n\r\n    return RichModel;\r\n}\r\n\r\nexport function ContactFactory(remotes = {}, defaults) {\r\n    const contact = new Contact();\r\n    Object.keys(remotes).forEach((remoteName, index) => {\r\n        contact.remote(remoteName, new Remote({ origin: remotes[remoteName] }), { default: index == 0 });\r\n    })\r\n    if (defaults) contact.default(defaults);\r\n    return contact;\r\n}\r\n\r\nexport function HooksFactory(options){\r\n    const hooks = new Hooks();\r\n    //解析hooks的逻辑，并添加hook记录\r\n    \r\n    Object\r\n        .keys(utils.defaults(options))\r\n        .forEach(hookName=>{\r\n            const hook = options[hookName];\r\n            Object.keys(hook).forEach(aboutName=>{\r\n                hooks.addHooks(`${hookName}::${aboutName}`, hook[aboutName]);\r\n            })\r\n        });\r\n\r\n    return hooks;\r\n}\r\n\r\nconst DataPlumber = {\r\n    Contact: ContactFactory,\r\n    Model: ModelFactory,\r\n    Hooks: HooksFactory,\r\n    Schema,\r\n    mapReceiveHook: utils.mapReceiveHook,\r\n    mapSendHook: utils.mapSendHook,\r\n    operations\r\n};\r\n\r\nexport default DataPlumber;\n\n\n// WEBPACK FOOTER //\n// ./src/DataPlumber.js","import { isNew, getURL, defaults, isDef } from \"../utils/\";\r\nimport Contact from './Contact.class';\r\n\r\nexport default class Model {\r\n    constructor(options) {\r\n        const name = this._name = options.name;\r\n        if(!isDef(name) || typeof name != 'string'){\r\n            throw new Error('options.name must be string in Model');\r\n        }\r\n        this._url = isDef(options.url) ? options.url : `/${name}`;\r\n        if (!isDef(options.contact) || options.contact.constructor != Contact){\r\n            throw new Error('options.contact must be Contact class in Model');\r\n        }\r\n        this._contact = options.contact;\r\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\r\n    }\r\n    fetch(params, opts) {\r\n        const { origin } = defaults(opts);\r\n        return this.remote(origin).get(this._url, params);\r\n    }\r\n    find(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).get(getURL(this._url, id, this._emulateIdKey), params );\r\n    }\r\n    save(data, opts) {\r\n        const { origin } = defaults(opts);\r\n        const { id } = data;\r\n        const url = getURL(this._url, id, this._emulateIdKey);\r\n        return this.remote(origin)[isNew(data) ? 'post' : 'put'](url, data);\r\n    }\r\n    delete(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).delete(getURL(this._url, id, this._emulateIdKey), params);\r\n    }\r\n    remote(name) {\r\n        return this._contact.remote(name);\r\n    }\r\n    get contact(){\r\n        return this._contact;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Model.class.js","import { convert } from \"../utils/\";\r\n\r\nexport const format = (data, fieldSet) => convert(fieldSet, { format:true })(data);\r\nexport const filter = (data, fields) => convert()(data, fields);\r\nexport const schema = fieldSet => convert(fieldSet, { format: true })({}, Object.keys(fieldSet));\r\n\r\nexport default class Schema {\r\n    constructor(fieldSet) {\r\n        this._fieldSet = fieldSet;\r\n    }\r\n    format(data) {\r\n        return format(data, this._fieldSet);\r\n    }\r\n    filter(data, fields = Object.keys(this._fieldSet)){\r\n        return filter(data, fields);\r\n    }\r\n    default(){\r\n        return schema(this._fieldSet);\r\n    }\r\n    get fieldSet() {\r\n        return this._fieldSet;\r\n    }\r\n\r\n    // static\r\n    static format(data, fieldSet){\r\n        return format(data, fieldSet);\r\n    }\r\n    static filter(data, fields) {\r\n        return filter(data, fields);\r\n    }\r\n    static default(fieldSet) {\r\n        return schema(fieldSet);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Schema.class.js"],"sourceRoot":""}