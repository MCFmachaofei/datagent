{"version":3,"sources":["webpack:///dataplumber.js","webpack:///webpack/bootstrap 785bb97a695efc430461","webpack:///./src/utils/index.js","webpack:///./src/classes/Method.class.js","webpack:///./src/classes/Hooks.class.js","webpack:///./src/classes/Contact.class.js","webpack:///./src/classes/Remote.class.js","webpack:///./src/index.js","webpack:///./src/DataPlumber.js","webpack:///./src/classes/Model.class.js","webpack:///./src/classes/Schema.class.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","_defineProperty","obj","key","value","writable","convert","format","arguments","length","undefined","options","defaults","data","fields","concat","keys","result","forEach","fieldName","fieldSet","isDef","formatField","type","default","to","defaultVal","val","isNumber","NaN","mapReceiveHook","methods","__WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__","ReceiveBehaviour","mapHooks","mapSendHook","SendBehaviour","Error","isArray","hooks","map","hookName","reduce","assign","isNew","getURL","compose","id","url","emulateIdKey","constructor","Array","Number","_len","list","_key","acc","fn","then","Promise","resolve","_toConsumableArray","arr","arr2","from","_classCallCheck","instance","Constructor","TypeError","__WEBPACK_IMPORTED_MODULE_0__utils___","_createClass","defineProperties","target","props","descriptor","protoProps","staticProps","Method","this","queues","queue","args","ctx","reject","catch","arg","x","y","Hooks","_map","Map","operations","set","size","_ref","method","hook","isReceiveBehaviour","isSendBehaviour","indexOf","__WEBPACK_IMPORTED_MODULE_0__Remote_class__","__WEBPACK_IMPORTED_MODULE_1__utils___","Contact","_remotes","_default_remote","remote","opts","has","RangeError","Remote","_origin","origin","params","sync","__WEBPACK_IMPORTED_MODULE_0__DataPlumber__","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","ModelFactory","schema","__WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__","fetch","__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__","find","save","delete","RichModel","_Model","_this","getPrototypeOf","initHooks","_hooks","HooksFactory","methodName","before","after","__WEBPACK_IMPORTED_MODULE_6__classes_Method_class__","getHooks","apply","scope","generate","ContactFactory","remotes","contact","__WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__","remoteName","index","__WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__","__WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__","aboutName","addHooks","_extends","source","DataPlumber","Model","Schema","__WEBPACK_IMPORTED_MODULE_1__Contact_class__","_name","_url","_contact","_emulateIdKey","_defaults","_defaults2","_defaults3","_defaults4","filter","_fieldSet"],"mappings":"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","file":"dataplumber.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return isNew; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return getURL; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return isDef; });\n/* unused harmony export isArray */\n/* unused harmony export isNumber */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return defaults; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return compose; });\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = convert;\n/* unused harmony export formatField */\n/* unused harmony export mapReceiveHook */\n/* unused harmony export mapSendHook */\n/* unused harmony export mapHooks */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__classes_Method_class__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__ = __webpack_require__(2);\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nvar isNew = function isNew(data) {\n    return !isDef(data.id);\n};\nvar getURL = function getURL(url, id, emulateIdKey) {\n    return emulateIdKey ? url : url + (isDef(id) ? '/' + id : '');\n};\nvar isDef = function isDef(val) {\n    return typeof val !== 'undefined';\n};\nvar isArray = function isArray(val) {\n    return val.constructor === Array;\n};\nvar isNumber = function isNumber(val) {\n    return val.constructor === Number;\n};\nvar defaults = function defaults(obj) {\n    var defaults = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var merge = function merge(defaults, obj) {\n        return defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\n    };\n    return isDef(obj) ? merge(defaults, obj) : defaults;\n};\n\nvar compose = function compose() {\n    for (var _len = arguments.length, list = Array(_len), _key = 0; _key < _len; _key++) {\n        list[_key] = arguments[_key];\n    }\n\n    return function (acc) {\n        return list.reduce(function (acc, fn) {\n            return acc.then(fn);\n        }, Promise.resolve(acc));\n    };\n};\n\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\nfunction convert() {\n    var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var options = arguments[1];\n\n    options = defaults(options, { format: false });\n    return function () {\n        var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [].concat(Object.keys(data), Object.keys(format));\n\n        var result = {};\n        fields.forEach(function (fieldName) {\n            var fieldSet = format[fieldName];\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\n        });\n        return result;\n    };\n}\n\nfunction formatField(to, defaultVal) {\n    return function (val) {\n        var result = void 0;\n        if (!isDef(val)) result = defaultVal;else result = to(val);\n        if (defaultVal === result) return result;\n        if (isNumber(result) && result === NaN) result = defaultVal;\n        if (result === null) result = defaultVal;\n        return result;\n    };\n}\n\nfunction mapReceiveHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].ReceiveBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapSendHook(methods, options) {\n    options = defaults(options, __WEBPACK_IMPORTED_MODULE_1__classes_Hooks_class__[\"a\" /* default */].SendBehaviour);\n    return mapHooks(methods, options);\n}\nfunction mapHooks(methods) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\n    var result = options.methods.map(function (hookName) {\n        return _defineProperty({}, hookName, {});\n    }).reduce(Object.assign);\n    Object.keys(result).forEach(function (hookName) {\n        result[hookName] = options.hooks.map(function (hookName) {\n            return _defineProperty({}, hookName, methods);\n        }).reduce(Object.assign);\n    });\n    return result;\n}\n\n/* harmony default export */ __webpack_exports__[\"c\"] = ({\n    isNew: isNew,\n    getURL: getURL,\n    isDef: isDef,\n    defaults: defaults,\n    convert: convert,\n    compose: compose,\n    mapSendHook: mapSendHook,\n    mapReceiveHook: mapReceiveHook\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// import compose from 'koa-compose';\n\n\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\n\nvar Method = function () {\n    function Method() {\n        _classCallCheck(this, Method);\n    }\n\n    _createClass(Method, null, [{\n        key: 'generate',\n        value: function generate(queues) {\n            var queue = __WEBPACK_IMPORTED_MODULE_0__utils___[\"a\" /* compose */].apply(undefined, _toConsumableArray(queues));\n            return function (args) {\n                var ctx = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n                ctx = Object.assign(ctx, { args: args });\n                return new Promise(function (resolve, reject) {\n                    queue(ctx).then(function (ctx) {\n                        return resolve(ctx.result);\n                    }).catch(reject);\n                });\n            };\n        }\n    }, {\n        key: 'concat',\n        value: function concat() {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            return args.map(function (arg) {\n                return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(arg, []);\n            }).reduce(function (x, y) {\n                return x.concat(y);\n            });\n        }\n    }]);\n\n    return Method;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Method);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Hooks = function () {\n    function Hooks() {\n        _classCallCheck(this, Hooks);\n\n        this._map = new Map();\n    }\n\n    _createClass(Hooks, [{\n        key: 'addHooks',\n        value: function addHooks(key, operations) {\n            return this._map.set(key, operations);\n        }\n    }, {\n        key: 'getHooks',\n        value: function getHooks(key) {\n            return this._map.get(key);\n        }\n    }, {\n        key: 'each',\n        value: function each(fn) {\n            return this._map.forEach(fn);\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return this._map.size;\n        }\n    }], [{\n        key: 'parse',\n        value: function parse(_ref) {\n            var method = _ref.method,\n                hook = _ref.hook;\n            var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'method';\n\n            var result = method + ':' + hook;\n            if (type === 'behaviour') {\n                if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\n                if (Hooks.isSendBehaviour(method, hook)) result = 'send';\n            }\n            return result;\n        }\n    }, {\n        key: 'isReceiveBehaviour',\n        value: function isReceiveBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\n            return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'isSendBehaviour',\n        value: function isSendBehaviour(method, hook) {\n            if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\n            if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\n            return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\n        }\n    }, {\n        key: 'ReceiveBehaviour',\n        get: function get() {\n            return {\n                methods: ['fetch', 'find'],\n                hooks: ['after']\n            };\n        }\n    }, {\n        key: 'SendBehaviour',\n        get: function get() {\n            return {\n                methods: ['save'],\n                hooks: ['before']\n            };\n        }\n    }]);\n\n    return Hooks;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Hooks);\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Remote_class__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Contact = function () {\n    function Contact() {\n        _classCallCheck(this, Contact);\n\n        this._remotes = {};\n        this._default_remote = \"\";\n    }\n\n    _createClass(Contact, [{\n        key: 'remote',\n        value: function remote() {\n            var name = arguments.length <= 0 ? undefined : arguments[0],\n                remote = arguments.length <= 1 ? undefined : arguments[1],\n                opts = Object(__WEBPACK_IMPORTED_MODULE_1__utils___[\"d\" /* defaults */])(arguments.length <= 2 ? undefined : arguments[2], { default: false });\n            if (arguments.length >= 2) {\n                // set remote\n                if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\n                if (remote.constructor !== __WEBPACK_IMPORTED_MODULE_0__Remote_class__[\"a\" /* default */]) throw new TypeError('The second arguments must be Remote');\n                this._remotes[name] = remote;\n                if (opts.default || this.length == 1) this.default(name);\n            } else {\n                name = name ? name : this._default_remote;\n                if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in remote()');\n                // get remote\n                remote = this._remotes[name];\n                return remote;\n            }\n        }\n    }, {\n        key: 'default',\n        value: function _default(name) {\n            if (typeof name !== 'string') throw new TypeError('The name must be string in default()');\n            if (!this.has(name)) throw new RangeError('Remote does not exist ' + name + ' in default()');\n            this._default_remote = name;\n        }\n    }, {\n        key: 'has',\n        value: function has(name) {\n            return Object.keys(this._remotes).indexOf(name) !== -1;\n        }\n    }, {\n        key: 'length',\n        get: function get() {\n            return Object.keys(this._remotes).length;\n        }\n    }]);\n\n    return Contact;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Contact);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Remote = function () {\n    function Remote(options) {\n        _classCallCheck(this, Remote);\n\n        this._origin = options.origin;\n    }\n\n    _createClass(Remote, [{\n        key: 'get',\n        value: function get(url, params) {\n            return this.sync({\n                url: url,\n                method: 'GET',\n                params: params\n            });\n        }\n    }, {\n        key: 'post',\n        value: function post(url, data) {\n            return this.sync({\n                method: 'POST',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'put',\n        value: function put(url, data) {\n            return this.sync({\n                method: 'PUT',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'patch',\n        value: function patch(url, data) {\n            return this.sync({\n                method: 'PATCH',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(url, data) {\n            return this.sync({\n                method: 'DELETE',\n                url: url,\n                data: data\n            });\n        }\n    }, {\n        key: 'sync',\n        value: function sync(options) {\n            return this._origin(options);\n        }\n    }, {\n        key: 'origin',\n        get: function get() {\n            return this._origin;\n        }\n    }]);\n\n    return Remote;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Remote);\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__DataPlumber__ = __webpack_require__(6);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (__WEBPACK_IMPORTED_MODULE_0__DataPlumber__[\"a\" /* default */]);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export ModelFactory */\n/* unused harmony export ContactFactory */\n/* unused harmony export HooksFactory */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__ = __webpack_require__(1);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\n\nfunction ModelFactory(options) {\n    var schema = new __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__[\"a\" /* default */](options.fields);\n    var methods = _extends({\n        'fetch': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.fetch,\n        'find': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.find,\n        'save': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.save,\n        'delete': __WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */].prototype.delete\n    }, options.methods);\n    //RichModel\n\n    var RichModel = function (_Model) {\n        _inherits(RichModel, _Model);\n\n        function RichModel(opts) {\n            _classCallCheck(this, RichModel);\n\n            opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts);\n            opts.name = options.name;\n\n            var _this = _possibleConstructorReturn(this, (RichModel.__proto__ || Object.getPrototypeOf(RichModel)).call(this, opts));\n\n            _this.initHooks(options.hooks);\n            return _this;\n        }\n\n        _createClass(RichModel, [{\n            key: 'initHooks',\n            value: function initHooks(options) {\n                this._hooks = HooksFactory(options);\n            }\n        }, {\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }], [{\n            key: 'schema',\n            get: function get() {\n                return schema;\n            }\n        }]);\n\n        return RichModel;\n    }(__WEBPACK_IMPORTED_MODULE_1__classes_Model_class__[\"a\" /* default */]);\n\n    Object.keys(methods).forEach(function (methodName) {\n        // all hook action magic in here.\n        RichModel.prototype[methodName] = function () {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            var opts = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(args[args.length - 1]);\n            var hooks = __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(opts.hooks, { before: [], after: [] });\n\n            before = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.before, this._hooks.getHooks(methodName + '::before'));\n            after = __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].concat(hooks.after, this._hooks.getHooks(methodName + '::after'));\n\n            var method = function method(ctx) {\n                return methods[methodName].apply(ctx.scope, ctx.args).then(function (data) {\n                    ctx.hook = 'after';\n                    ctx.result = data;\n                    return Promise.resolve(ctx);\n                });\n            };\n            var ctx = { scope: this, method: methodName, hook: 'before' };\n\n            return __WEBPACK_IMPORTED_MODULE_6__classes_Method_class__[\"a\" /* default */].generate([].concat(_toConsumableArray(before), [method], _toConsumableArray(after)))(args, ctx);\n        };\n    });\n\n    return RichModel;\n}\n\nfunction ContactFactory() {\n    var remotes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var defaults = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'base';\n\n    var contact = new __WEBPACK_IMPORTED_MODULE_3__classes_Contact_class__[\"a\" /* default */]();\n    Object.keys(remotes).forEach(function (remoteName, index) {\n        contact.remote(remoteName, new __WEBPACK_IMPORTED_MODULE_4__classes_Remote_class__[\"a\" /* default */]({ origin: remotes[remoteName] }), { default: index == 0 });\n    });\n    return contact;\n}\n\nfunction HooksFactory(options) {\n    var hooks = new __WEBPACK_IMPORTED_MODULE_2__classes_Hooks_class__[\"a\" /* default */]();\n    //解析hooks的逻辑，并添加hook记录\n\n    Object.keys(__WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].defaults(options)).forEach(function (hookName) {\n        var hook = options[hookName];\n        Object.keys(hook).forEach(function (aboutName) {\n            hooks.addHooks(hookName + '::' + aboutName, hook[aboutName]);\n        });\n    });\n\n    return hooks;\n}\n\nvar DataPlumber = {\n    Contact: ContactFactory,\n    Model: ModelFactory,\n    Hooks: HooksFactory,\n    Schema: __WEBPACK_IMPORTED_MODULE_5__classes_Schema_class__[\"a\" /* default */],\n    mapReceiveHook: __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].mapReceiveHook,\n    mapSendHook: __WEBPACK_IMPORTED_MODULE_0__utils___[\"c\" /* default */].mapSendHook\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DataPlumber);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Contact_class__ = __webpack_require__(3);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar Model = function () {\n    function Model(options) {\n        _classCallCheck(this, Model);\n\n        var name = this._name = options.name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(name) || typeof name != 'string') {\n            throw new Error('options.name must be string in Model');\n        }\n        this._url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(options.url) ? options.url : '/' + name;\n        if (!Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"f\" /* isDef */])(options.contact) || options.contact.constructor != __WEBPACK_IMPORTED_MODULE_1__Contact_class__[\"a\" /* default */]) {\n            throw new Error('options.contact must be Contact class in Model');\n        }\n        this._contact = options.contact;\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\n    }\n\n    _createClass(Model, [{\n        key: 'fetch',\n        value: function fetch(params, opts) {\n            var _defaults = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults.origin;\n\n            return this.remote(origin).get(this._url, params);\n        }\n    }, {\n        key: 'find',\n        value: function find(id, opts) {\n            var _defaults2 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults2.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).get(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'save',\n        value: function save(data, opts) {\n            var _defaults3 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults3.origin;\n\n            var id = data.id;\n\n            var url = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey);\n            return this.remote(origin)[Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"g\" /* isNew */])(data) ? 'post' : 'put'](url, data);\n        }\n    }, {\n        key: 'delete',\n        value: function _delete(id, opts) {\n            var _defaults4 = Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"d\" /* defaults */])(opts),\n                origin = _defaults4.origin;\n\n            var params = this._emulateIdKey ? _defineProperty({}, this._emulateIdKey, id) : {};\n            return this.remote(origin).delete(Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"e\" /* getURL */])(this._url, id, this._emulateIdKey), params);\n        }\n    }, {\n        key: 'remote',\n        value: function remote(name) {\n            return this._contact.remote(name);\n        }\n    }, {\n        key: 'contact',\n        get: function get() {\n            return this._contact;\n        }\n    }]);\n\n    return Model;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Model);\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export format */\n/* unused harmony export filter */\n/* unused harmony export schema */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils___ = __webpack_require__(0);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\nvar _format = function _format(data, fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })(data);\n};\n\nvar _filter = function _filter(data, fields) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])()(data, fields);\n};\n\nvar schema = function schema(fieldSet) {\n    return Object(__WEBPACK_IMPORTED_MODULE_0__utils___[\"b\" /* convert */])(fieldSet, { format: true })({}, Object.keys(fieldSet));\n};\n\nvar Schema = function () {\n    function Schema(fieldSet) {\n        _classCallCheck(this, Schema);\n\n        this._fieldSet = fieldSet;\n    }\n\n    _createClass(Schema, [{\n        key: \"format\",\n        value: function format(data) {\n            return _format(data, this._fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data) {\n            var fields = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Object.keys(this._fieldSet);\n\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default() {\n            return schema(this._fieldSet);\n        }\n    }, {\n        key: \"fieldSet\",\n        get: function get() {\n            return this._fieldSet;\n        }\n\n        // static\n\n    }], [{\n        key: \"format\",\n        value: function format(data, fieldSet) {\n            return _format(data, fieldSet);\n        }\n    }, {\n        key: \"filter\",\n        value: function filter(data, fields) {\n            return _filter(data, fields);\n        }\n    }, {\n        key: \"default\",\n        value: function _default(fieldSet) {\n            return schema(fieldSet);\n        }\n    }]);\n\n    return Schema;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Schema);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// dataplumber.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 785bb97a695efc430461","import Method from '../classes/Method.class';\r\nimport Hooks from '../classes/Hooks.class';\r\n\r\nexport const isNew = data => !isDef(data.id);\r\nexport const getURL = (url, id, emulateIdKey) => emulateIdKey ? url : (url + (isDef(id) ? `/${id}` : ''));\r\nexport const isDef = val => typeof val !== 'undefined';\r\nexport const isArray = val => val.constructor === Array;\r\nexport const isNumber = val => val.constructor === Number;\r\nexport const defaults = (obj, defaults = {}) =>{\r\n    const merge = (defaults, obj) => defaults.constructor === Array ? defaults.concat(obj) : Object.assign(defaults, obj);\r\n    return isDef(obj) ? merge(defaults, obj) : defaults;\r\n};\r\n\r\nexport const compose = (...list) => acc => list.reduce((acc, fn) => acc.then(fn), Promise.resolve(acc));\r\n\r\n/**\r\n * format code like that:\r\n * ```\r\n * {\r\n *   \"id\": { type: Number, default: null },\r\n *   \"nickname\": { type: String, default: \"\" },\r\n *   \"emial\": { type: String, default:\"\" },\r\n *   \"password\": { type: String, default:\"\" }\r\n * }\r\n * ```\r\n */\r\nexport function convert(format = {}, options){\r\n    options = defaults(options, { format: false });\r\n    return (data = {}, fields = [].concat(Object.keys(data), Object.keys(format)))=>{\r\n        const result = {};\r\n        fields.forEach(fieldName => {\r\n            const fieldSet = format[fieldName];\r\n            if (isDef(data[fieldName])) result[fieldName] = data[fieldName];\r\n            if (options.format && isDef(fieldSet)) result[fieldName] = formatField(fieldSet.type, fieldSet.default)(data[fieldName]);\r\n        });\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function formatField(to, defaultVal){\r\n    return val=>{\r\n        let result;\r\n        if(!isDef(val)) result = defaultVal;\r\n        else result = to(val);\r\n        if (defaultVal === result) return result;\r\n        if (isNumber(result) && result === NaN) result = defaultVal;\r\n        if (result === null) result = defaultVal;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport function mapReceiveHook(methods, options){\r\n    options = defaults(options, Hooks.ReceiveBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapSendHook(methods, options) {\r\n    options = defaults(options, Hooks.SendBehaviour);\r\n    return mapHooks(methods, options)\r\n}\r\nexport function mapHooks(methods, options={}){\r\n    if (!isDef(options.methods)) throw new Error('The options must have methods parameter in mapHooks');\r\n    if (!isArray(options.methods)) throw new Error('The options.methods must be Array in mapHooks');\r\n    if (!isDef(options.hooks)) throw new Error('The options must have hooks parameter in mapHooks');\r\n    if (!isArray(options.hooks)) throw new Error('The options.hooks must be Array in mapHooks');\r\n    const result = options.methods.map(hookName => { return { [hookName]: {} } }).reduce(Object.assign);\r\n    Object.keys(result).forEach(hookName=>{\r\n        result[hookName] = options.hooks.map(hookName => { return { [hookName]: methods } }).reduce(Object.assign);\r\n    })\r\n    return result;\r\n}\r\n\r\nexport default {\r\n    isNew,\r\n    getURL,\r\n    isDef,\r\n    defaults,\r\n    convert,\r\n    compose,\r\n    mapSendHook,\r\n    mapReceiveHook\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","// import compose from 'koa-compose';\r\nimport { defaults, compose } from '../utils/';\r\n\r\n/**\r\n * queue call function like that:\r\n * ```\r\n * (ctx, next) => {\r\n *   // ctx is content in all queue functions, like koa.\r\n *   // ctx have $model, arge, result fields\r\n *   // ======================================================\r\n *   // ctx.$model is function scope\r\n *   // ctx.arge is function arguments\r\n *   // ctx.result is this function result\r\n *   next();\r\n * }\r\n * ```\r\n * \r\n * run function return Promise data pattern like that:\r\n * ```\r\n * let err, result;\r\n * [err, result] = Queue.run($model, args, queues);\r\n * if(err) throw err;\r\n * console.log(result);\r\n * ```\r\n * more detail look test file.\r\n */\r\n\r\nclass Method {\r\n    static generate(queues) {\r\n        const queue = compose(...queues);\r\n        return (args, ctx={}) => {\r\n            ctx = Object.assign(ctx, {args});\r\n            return new Promise((resolve, reject) => {\r\n                queue(ctx)\r\n                    .then(ctx=>resolve(ctx.result))\r\n                    .catch(reject);\r\n            });\r\n        }\r\n    }\r\n    static concat(...args){\r\n        return args.map(arg => defaults(arg, [])).reduce((x,y)=>x.concat(y));\r\n    }\r\n}\r\n\r\nexport default Method;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Method.class.js","class Hooks {\r\n    constructor() {\r\n        this._map = new Map();\r\n    }\r\n    addHooks(key, operations) {\r\n        return this._map.set(key, operations);\r\n    }\r\n    getHooks(key) {\r\n        return this._map.get(key);\r\n    }\r\n    each(fn) {\r\n        return this._map.forEach(fn);\r\n    }\r\n    get length() {\r\n        return this._map.size;\r\n    }\r\n\r\n    static parse({ method, hook }, type = 'method'){\r\n        let result = `${method}:${hook}`;\r\n        if (type === 'behaviour') {\r\n            if (Hooks.isReceiveBehaviour(method, hook)) result = 'receive';\r\n            if (Hooks.isSendBehaviour(method, hook)) result = 'send';\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static get ReceiveBehaviour(){\r\n        return {\r\n            methods: ['fetch','find'],\r\n            hooks: ['after']\r\n        }\r\n    }\r\n    static get SendBehaviour() {\r\n        return {\r\n            methods: ['save'],\r\n            hooks: ['before']\r\n        }\r\n    }\r\n\r\n    static isReceiveBehaviour(method, hook){\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isReceiveBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isReceiveBehaviour()');\r\n        return Hooks.ReceiveBehaviour.methods.indexOf(method) > -1 && Hooks.ReceiveBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n\r\n    static isSendBehaviour(method, hook) {\r\n        if (typeof method !== 'string') throw new TypeError('The method must be string in isSendBehaviour()');\r\n        if (typeof hook !== 'string') throw new TypeError('The hook must be string in isSendBehaviour()');\r\n        return Hooks.SendBehaviour.methods.indexOf(method) > -1 && Hooks.SendBehaviour.hooks.indexOf(hook) > -1;\r\n    }\r\n}\r\n\r\nexport default Hooks;\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Hooks.class.js","import Remote from './Remote.class';\r\nimport { defaults } from '../utils/';\r\n\r\nexport default class Contact {\r\n    constructor() {\r\n        this._remotes = {};\r\n        this._default_remote = \"\";\r\n    }\r\n    remote(...args) {\r\n        let name = args[0],\r\n            remote = args[1],\r\n            opts = defaults(args[2], { default: false });\r\n        if (args.length >= 2) {\r\n            // set remote\r\n            if (typeof name !== 'string') throw new TypeError('The first arguments must be String');\r\n            if (remote.constructor !== Remote) throw new TypeError('The second arguments must be Remote');\r\n            this._remotes[name] = remote;\r\n            if (opts.default || this.length == 1) this.default(name);\r\n        } else {\r\n            name = name ? name : this._default_remote;\r\n            if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in remote()`);\r\n            // get remote\r\n            remote = this._remotes[name];\r\n            return remote;\r\n        }\r\n    }\r\n    default(name) {\r\n        if(typeof name !== 'string') throw new TypeError('The name must be string in default()');\r\n        if (!this.has(name)) throw new RangeError(`Remote does not exist ${name} in default()`);\r\n        this._default_remote = name;\r\n    }\r\n    has(name) {\r\n        return Object.keys(this._remotes).indexOf(name) !== -1;\r\n    }\r\n    get length() {\r\n        return Object.keys(this._remotes).length;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Contact.class.js","export default class Remote {\r\n    constructor(options) {\r\n        this._origin = options.origin;\r\n    }\r\n    get(url, params) {\r\n        return this.sync({\r\n            url,\r\n            method: 'GET',\r\n            params\r\n        });\r\n    }\r\n    post(url, data) {\r\n        return this.sync({\r\n            method: 'POST',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    put(url, data) {\r\n        return this.sync({\r\n            method: 'PUT',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    patch(url, data) {\r\n        return this.sync({\r\n            method: 'PATCH',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    delete(url, data) {\r\n        return this.sync({\r\n            method: 'DELETE',\r\n            url,\r\n            data\r\n        });\r\n    }\r\n    sync(options){\r\n        return this._origin(options);\r\n    }\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Remote.class.js","import DataPlumber from './DataPlumber';\r\nexport default DataPlumber;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import utils from './utils/';\r\nimport Model from './classes/Model.class';\r\nimport Hooks from './classes/Hooks.class';\r\nimport Contact from './classes/Contact.class';\r\nimport Remote from './classes/Remote.class';\r\nimport Schema from './classes/Schema.class';\r\nimport Method from './classes/Method.class';\r\n\r\nexport function ModelFactory(options) {\r\n    const schema = new Schema(options.fields);\r\n    const methods = {\r\n        'fetch': Model.prototype.fetch,\r\n        'find': Model.prototype.find,\r\n        'save': Model.prototype.save,\r\n        'delete': Model.prototype.delete,\r\n        ...options.methods\r\n    }\r\n    //RichModel\r\n    class RichModel extends Model{\r\n        constructor(opts){\r\n            opts = utils.defaults(opts);\r\n            opts.name = options.name;\r\n            super(opts);\r\n            this.initHooks(options.hooks);\r\n        }\r\n        initHooks(options){\r\n            this._hooks = HooksFactory(options);\r\n        }\r\n        get schema(){\r\n            return schema;\r\n        }\r\n        static get schema(){\r\n            return schema;\r\n        }\r\n    }\r\n    Object\r\n        .keys(methods)\r\n        .forEach(methodName => {\r\n            // all hook action magic in here.\r\n            RichModel.prototype[methodName] = function (...args){\r\n                const opts = utils.defaults(args[args.length-1]);\r\n                const hooks = utils.defaults(opts.hooks, { before: [], after: [] });\r\n\r\n                before = Method.concat(hooks.before, this._hooks.getHooks(`${methodName}::before`));\r\n                after = Method.concat(hooks.after, this._hooks.getHooks(`${methodName}::after`));\r\n\r\n                const method = (ctx) => methods[methodName].apply(ctx.scope, ctx.args).then(data => {\r\n                    ctx.hook = 'after';\r\n                    ctx.result = data;\r\n                    return Promise.resolve(ctx);\r\n                });\r\n                const ctx = { scope: this, method: methodName, hook: 'before' };\r\n\r\n                return Method.generate([...before, method, ...after])(args, ctx);\r\n            }\r\n        });\r\n\r\n    return RichModel;\r\n}\r\n\r\nexport function ContactFactory(remotes = {}, defaults = 'base') {\r\n    const contact = new Contact();\r\n    Object.keys(remotes).forEach((remoteName, index) => {\r\n        contact.remote(remoteName, new Remote({ origin: remotes[remoteName] }), { default: index == 0 });\r\n    })\r\n    return contact;\r\n}\r\n\r\nexport function HooksFactory(options){\r\n    const hooks = new Hooks();\r\n    //解析hooks的逻辑，并添加hook记录\r\n    \r\n    Object\r\n        .keys(utils.defaults(options))\r\n        .forEach(hookName=>{\r\n            const hook = options[hookName];\r\n            Object.keys(hook).forEach(aboutName=>{\r\n                hooks.addHooks(`${hookName}::${aboutName}`, hook[aboutName]);\r\n            })\r\n        });\r\n\r\n    return hooks;\r\n}\r\n\r\nconst DataPlumber = {\r\n    Contact: ContactFactory,\r\n    Model: ModelFactory,\r\n    Hooks: HooksFactory,\r\n    Schema,\r\n    mapReceiveHook: utils.mapReceiveHook,\r\n    mapSendHook: utils.mapSendHook,\r\n};\r\n\r\nexport default DataPlumber;\n\n\n// WEBPACK FOOTER //\n// ./src/DataPlumber.js","import { isNew, getURL, defaults, isDef } from \"../utils/\";\r\nimport Contact from './Contact.class';\r\n\r\nexport default class Model {\r\n    constructor(options) {\r\n        const name = this._name = options.name;\r\n        if(!isDef(name) || typeof name != 'string'){\r\n            throw new Error('options.name must be string in Model');\r\n        }\r\n        this._url = isDef(options.url) ? options.url : `/${name}`;\r\n        if (!isDef(options.contact) || options.contact.constructor != Contact){\r\n            throw new Error('options.contact must be Contact class in Model');\r\n        }\r\n        this._contact = options.contact;\r\n        this._emulateIdKey = typeof options.emulateIdKey === 'undefined' ? false : options.emulateIdKey;\r\n    }\r\n    fetch(params, opts) {\r\n        const { origin } = defaults(opts);\r\n        return this.remote(origin).get(this._url, params);\r\n    }\r\n    find(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).get(getURL(this._url, id, this._emulateIdKey), params );\r\n    }\r\n    save(data, opts) {\r\n        const { origin } = defaults(opts);\r\n        const { id } = data;\r\n        const url = getURL(this._url, id, this._emulateIdKey);\r\n        return this.remote(origin)[isNew(data) ? 'post' : 'put'](url, data);\r\n    }\r\n    delete(id, opts) {\r\n        const { origin } = defaults(opts);\r\n        const params = this._emulateIdKey ? { [this._emulateIdKey]: id } : {};\r\n        return this.remote(origin).delete(getURL(this._url, id, this._emulateIdKey), params);\r\n    }\r\n    remote(name) {\r\n        return this._contact.remote(name);\r\n    }\r\n    get contact(){\r\n        return this._contact;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Model.class.js","import { convert } from \"../utils/\";\r\n\r\nexport const format = (data, fieldSet) => convert(fieldSet, { format:true })(data);\r\nexport const filter = (data, fields) => convert()(data, fields);\r\nexport const schema = fieldSet => convert(fieldSet, { format: true })({}, Object.keys(fieldSet));\r\n\r\nexport default class Schema {\r\n    constructor(fieldSet) {\r\n        this._fieldSet = fieldSet;\r\n    }\r\n    format(data) {\r\n        return format(data, this._fieldSet);\r\n    }\r\n    filter(data, fields = Object.keys(this._fieldSet)){\r\n        return filter(data, fields);\r\n    }\r\n    default(){\r\n        return schema(this._fieldSet);\r\n    }\r\n    get fieldSet() {\r\n        return this._fieldSet;\r\n    }\r\n\r\n    // static\r\n    static format(data, fieldSet){\r\n        return format(data, fieldSet);\r\n    }\r\n    static filter(data, fields) {\r\n        return filter(data, fields);\r\n    }\r\n    static default(fieldSet) {\r\n        return schema(fieldSet);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/classes/Schema.class.js"],"sourceRoot":""}